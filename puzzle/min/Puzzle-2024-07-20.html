<!DOCTYPE html><html><meta charset="UTF-8"><head><style>#box{border:1px solid #000;background-color:#fff}.controller{display:flex;width:602px}#next,#previous{font-size:5em;flex-grow:1;height:2em;color:#fff}#next[disabled],#previous[disabled]{background-color:gray}#previous{background-color:red}#next{background-color:green}</style></head><body><canvas id="box" width="600" height="600"></canvas><div class="controller"><button id="previous" onclick="onPreviousClicked()">&lt;</button> <button id="next" onclick="onNextClicked()">&gt;</button></div><script>const boxEl=document.getElementById("box"),canvas=boxEl.getContext("2d"),previousEl=document.getElementById("previous"),nextEl=document.getElementById("next");let blocks=[{p:[1,0],h:1,v:2},{p:[2,1],h:2,v:1},{p:[4,0],h:1,v:3},{p:[5,0],h:1,v:2},{p:[2,2],h:1,v:2},{p:[3,3],h:2,v:1},{p:[0,3],h:1,v:3},{p:[1,4],h:2,v:1},{p:[1,5],h:2,v:1},{p:[3,4],h:1,v:2},{p:[4,5],h:2,v:1}],key={p:[0,2],h:2,v:1};const operations=[{b:5,h:1},{b:9,v:-2},{b:7,h:3},{b:4,v:1},{b:9,v:2},{h:2},{b:0,v:3},{h:-2},{b:1,h:-2},{b:4,v:-3},{b:9,v:-4},{h:2},{b:6,v:-1},{b:0,v:-1},{b:8,h:-1},{b:5,h:-2},{b:7,h:-3},{b:10,h:-2},{b:2,v:3},{b:3,v:3},{h:2}],guides=[[5,3,1,0,1],[3,2,0,2,-1],[3,4,3,0,1],[2,4,0,1,1],[3,4,0,2,1],[2,2,2,0,1],[1,2,0,3,1],[0,2,2,0,-1],[0,1,2,0,-1],[2,0,0,3,-1],[3,0,0,4,-1],[2,2,2,0,1],[0,2,0,1,-1],[1,2,0,1,-1],[0,5,1,0,-1],[2,3,2,0,-1],[1,4,3,0,-1],[2,5,2,0,-1],[4,3,0,3,1],[5,2,0,3,1],[4,2,2,0,1]];let step=0;function onPreviousClicked(){--step<0?step=0:(previousOperation(),draw())}function onNextClicked(){(step+=1)>operations.length?step=operations.length:(nextOperation(),draw())}function previousOperation(){applyOperation(inverseOperation(operations[step]))}function nextOperation(){applyOperation(operations[step-1])}function applyOperation(e){var t=void 0===e.b?key:blocks[e.b];e.h&&(t.p[0]+=e.h),e.v&&(t.p[1]+=e.v)}function inverseOperation(e){return{...e,h:-e.h,v:-e.v}}function draw(){checkControllerState(),clearCanvas(),drawBlocks(),drawGuides(),drawKey()}function disableIf(e,t){t?e.setAttribute("disabled",""):e.removeAttribute("disabled")}function checkControllerState(){disableIf(previousEl,0===step),disableIf(nextEl,step===operations.length)}function clearCanvas(){canvas.clearRect(0,0,boxEl.width,boxEl.height)}function toCanvasCoord(e){var t=100;return[e.p[0]*t,e.p[1]*t,e.h*t,e.v*t]}function textCoord(e,t,a,n,o){return[t+n/2-(1<e.length?20:10),a+o/2+15]}function drawKey(){canvas.beginPath();var[e,t,a,n]=toCanvasCoord(key);canvas.fillStyle="yellow",canvas.fillRect(e,t,a,n),canvas.rect(e,t,a,n),canvas.stroke()}function drawBlocks(){canvas.beginPath();let r=0;blocks.forEach(e=>{var[e,t,a,n]=toCanvasCoord(e),o=(canvas.fillStyle=a<n?"red":"green",canvas.fillRect(e,t,a,n),canvas.rect(e,t,a,n),r.toString()),[e,t]=textCoord(o,e,t,a,n);canvas.font="3em Arial",canvas.fillStyle="black",canvas.fillText(o,e,t),r+=1}),canvas.stroke()}function drawGuides(){var e=guides[step];if(e){var t=e[0],a=e[1],n=e[2],o=e[3],e=e[4];if(canvas.beginPath(),0!==n){var r=1===e?">":"<";for(let e=0;e<n;e+=1)drawGuide(t+e,a,r)}if(0!==o){var i=1===e?"˅":"˄";for(let e=0;e<o;e+=1)drawGuide(t,a+e,i)}canvas.stroke()}}function drawGuide(e,t,a){var[e,t,n,o]=toCanvasCoord({p:[e,t],h:1,v:1}),[e,t]=(canvas.fillStyle="lightgray",canvas.fillRect(e,t,n,o),textCoord(a,e,t,n,o));canvas.font="3em Arial",canvas.fillStyle="yellow",canvas.fillText(a,e,t)}draw()</script></body></html>